Overview

Exponential Adaptive Normalization (EAN) rescales each sliding window using exponentially weighted statistics so that the model focuses on shape rather than absolute level. This is helpful when the series level drifts over time (non-stationary mean/variance).

Key parameter
- `nw`: the effective window span for the exponential averages; smaller values adapt faster to recent changes.

```{r}
# Exponential Adaptive Normalization

# Install tspredit if needed
#install.packages("tspredit")
```

```{r}
# Load packages
library(daltoolbox)
library(tspredit) 
```


```{r}
# Load a sample series

data(tsd)
```

```{r}
library(ggplot2)
# Visualize original series
plot_ts(x=tsd$x, y=tsd$y) + theme(text = element_text(size=16))
```

```{r}
# Build sliding windows for supervised learning

sw_size <- 10
ts <- ts_data(tsd$y, sw_size)
ts_head(ts, 3)
summary(ts[,10])
```

```{r}
library(ggplot2)
# Visualize the target column (t0) after windowing
plot_ts(y=ts[,10]) + theme(text = element_text(size=16))
```

```{r}
# Apply Exponential Adaptive Normalization

preproc <- ts_norm_ean(nw = 3)   # faster adaptation with smaller nw
preproc <- fit(preproc, ts)
tst <- transform(preproc, ts)
ts_head(tst, 3)
summary(tst[,10])

# Inspect one normalized window (shape emphasized)
plot_ts(y=ts[1,]) + theme(text = element_text(size=16))
```

